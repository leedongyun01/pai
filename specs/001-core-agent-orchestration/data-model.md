# Data Model: Core Agent Orchestration

## Domain Entities

### ResearchSession
The root aggregate for a user's research interaction.

```typescript
type ResearchSession = {
  id: string; // UUID
  query: string; // User input
  mode: ResearchMode;
  status: ResearchStatus;
  plan?: ResearchPlan;
  createdAt: string; // ISO Date
  updatedAt: string; // ISO Date
  error?: string; // Optional error message
};
```

### ResearchPlan
The structured strategy generated by the agent.

```typescript
type ResearchPlan = {
  sessionId: string;
  rationale: string; // "Selected Deep Probe because..."
  steps: PlanStep[];
};
```

### PlanStep
An atomic unit of work in the research process.

```typescript
type PlanStep = {
  id: string; // simple numeric or short string
  type: 'search' | 'analyze'; 
  description: string; // "Search for X"
  searchQueries?: string[]; // For search steps
};
```

## Enums

### ResearchMode
```typescript
type ResearchMode = 'quick_scan' | 'deep_probe';
```

### ResearchStatus
```typescript
type ResearchStatus = 
  | 'idle'           // Initial state
  | 'analyzing'      // Determining mode
  | 'planning'       // Generating plan
  | 'review_pending' // Waiting for user approval (Deep Probe only)
  | 'executing'      // Running tasks
  | 'completed'      // Finished
  | 'error';         // Failed
```

## Storage Schema
File: `.data/sessions/<id>.json`

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "query": "Future of AI",
  "mode": "deep_probe",
  "status": "review_pending",
  "plan": {
    "sessionId": "550e8400-e29b-41d4-a716-446655440000",
    "rationale": "Complex topic requiring historical context.",
    "steps": [
      {
        "id": "1",
        "type": "search",
        "description": "Find key AI milestones 2020-2025",
        "searchQueries": ["AI milestones 2020-2025", "LLM history"]
      }
    ]
  },
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:05Z"
}
```
